# ä¸­ä½æ•°æ˜¯æœ‰åºåºåˆ—æœ€ä¸­é—´çš„é‚£ä¸ªæ•°ã€‚å¦‚æœåºåˆ—çš„å¤§å°æ˜¯å¶æ•°ï¼Œåˆ™æ²¡æœ‰æœ€ä¸­é—´çš„æ•°ï¼›æ­¤æ—¶ä¸­ä½æ•°æ˜¯æœ€ä¸­é—´çš„ä¸¤ä¸ªæ•°çš„å¹³å‡æ•°ã€‚ 
# 
#  ä¾‹å¦‚ï¼š 
# 
#  
#  [2,3,4]ï¼Œä¸­ä½æ•°æ˜¯ 3 
#  [2,3]ï¼Œä¸­ä½æ•°æ˜¯ (2 + 3) / 2 = 2.5 
#  
# 
#  ç»™ä½ ä¸€ä¸ªæ•°ç»„ numsï¼Œæœ‰ä¸€ä¸ªå¤§å°ä¸º k çš„çª—å£ä»æœ€å·¦ç«¯æ»‘åŠ¨åˆ°æœ€å³ç«¯ã€‚çª—å£ä¸­æœ‰ k ä¸ªæ•°ï¼Œæ¯æ¬¡çª—å£å‘å³ç§»åŠ¨ 1 ä½ã€‚ä½ çš„ä»»åŠ¡æ˜¯æ‰¾å‡ºæ¯æ¬¡çª—å£ç§»åŠ¨åå¾—åˆ°çš„æ–°çª—
# å£ä¸­å…ƒç´ çš„ä¸­ä½æ•°ï¼Œå¹¶è¾“å‡ºç”±å®ƒä»¬ç»„æˆçš„æ•°ç»„ã€‚ 
# 
#  
# 
#  ç¤ºä¾‹ï¼š 
# 
#  ç»™å‡º nums = [1,3,-1,-3,5,3,6,7]ï¼Œä»¥åŠ k = 3ã€‚ 
# 
#  çª—å£ä½ç½®                      ä¸­ä½æ•°
# ---------------               -----
# [1  3  -1] -3  5  3  6  7       1
#  1 [3  -1  -3] 5  3  6  7      -1
#  1  3 [-1  -3  5] 3  6  7      -1
#  1  3  -1 [-3  5  3] 6  7       3
#  1  3  -1  -3 [5  3  6] 7       5
#  1  3  -1  -3  5 [3  6  7]      6
#  
# 
#  å› æ­¤ï¼Œè¿”å›è¯¥æ»‘åŠ¨çª—å£çš„ä¸­ä½æ•°æ•°ç»„ [1,-1,-1,3,5,6]ã€‚ 
# 
#  
# 
#  æç¤ºï¼š 
# 
#  
#  ä½ å¯ä»¥å‡è®¾ k å§‹ç»ˆæœ‰æ•ˆï¼Œå³ï¼šk å§‹ç»ˆå°äºè¾“å…¥çš„éç©ºæ•°ç»„çš„å…ƒç´ ä¸ªæ•°ã€‚ 
#  ä¸çœŸå®å€¼è¯¯å·®åœ¨ 10 ^ -5 ä»¥å†…çš„ç­”æ¡ˆå°†è¢«è§†ä½œæ­£ç¡®ç­”æ¡ˆã€‚ 
#  
#  Related Topics Sliding Window 
#  ğŸ‘ 104 ğŸ‘ 0

class Solution:
    def medianSlidingWindow1(self, nums: List[int], k: int) -> List[float]:
        # äºŒåˆ†æ³•ï¼Œéœ€è¦å€ŸåŠ©bisectè¿™ä¸ªåº“ï¼ˆå‰ææ•°ç»„æœ‰åºï¼‰
        import bisect
        arr,res,left = [],[],0
        for right in range(len(nums)):
            # æŒ‰æ’åºä½ç½®æ’å…¥
            bisect.insort(arr, nums[right])
            while len(arr) > k:
                arr.pop(bisect.bisect_left(arr, nums[left]))
                left += 1
            if len(arr) == k:
                res.append((arr[k // 2] + arr[(k - 1) // 2]) / 2.0)
        return res
    def medianSlidingWindow(self, nums: List[int], k: int) -> List[float]:
        # ç»´æŠ¤å¤§å°ä¸ºkçš„çª—å£æœ‰åºï¼Œå¹¶ç”¨äºŒåˆ†æ³•æ’å…¥æ–°çš„å…ƒç´ ã€‚ç›´æ¥å¥—ç”¨ sliding window æ¨¡æ¿
        import bisect
        lo, hi = 0, 0
        ans = []
        window = []
        # å¥—ç”¨ sliding window æ¨¡æ¿
        while hi < len(nums):
            # ç¬¬ä¸€æ­¥ï¼Œå…¥çª—å°±å®Œäº‹äº†
            bisect.insort_left(window, nums[hi])
            # ç¬¬äºŒæ­¥ï¼Œç»´æŠ¤çª—å£ï¼Œè¯¥å‡ºçª—å¾—å‡ºçª—
            while len(window) > k:
                # å‡ºçª—
                window.pop(bisect.bisect_left(window, nums[lo]))
                # çª—å£å·¦ç«¯æ”¶ç¼©
                lo += 1
            # ç¬¬ä¸‰æ­¥ï¼Œåšè¯¥åšçš„äº‹
            if len(window) == k:
                # æ³¨æ„è¿™ä¸ªæ±‚ä¸­ä½æ•°çš„è¡¨è¾¾å¼ï¼Œæ— è®ºlen(window)å¥‡å¶éƒ½å¦‚æ­¤
                ans.append((window[k // 2] + window[(k - 1) // 2]) / 2)
            # æœ€åï¼Œçª—å£å³ç«¯å§‹ç»ˆå³ç§»ï¼Œåœ¨è·¯ä¸Š
            hi += 1
        return ans